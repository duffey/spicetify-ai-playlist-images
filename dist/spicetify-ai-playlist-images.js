!async function(){for(;!Spicetify.React||!Spicetify.ReactDOM;)await new Promise(e=>setTimeout(e,10));(()=>{var B=Object.defineProperty,t="4.28.4",e=!1,r=void 0,$=void 0,q=void 0,F=void 0,N=void 0,U=void 0,W=void 0,D=void 0,X=void 0;var H=class{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}};if(!r){var s=function({manuallyImported:e}={}){const t=e?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let s,n,r,i;try{s=fetch,n=Request,r=Response,i=Headers}catch(e){throw new Error(`this environment is missing the following Web Fetch API type: ${e.message}. `+t)}return{kind:"web",fetch:s,Request:n,Response:r,Headers:i,FormData:"undefined"!=typeof FormData?FormData:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'FormData' is undefined. "+t)}},Blob:"undefined"!=typeof Blob?Blob:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'Blob' is undefined. "+t)}},File:"undefined"!=typeof File?File:class{constructor(){throw new Error("file uploads aren't supported in this environment yet as 'File' is undefined. "+t)}},ReadableStream:"undefined"!=typeof ReadableStream?ReadableStream:class{constructor(){throw new Error("streaming isn't supported in this environment yet as 'ReadableStream' is undefined. "+t)}},getMultipartRequestOptions:async(e,t)=>({...t,body:new H(e)}),getDefaultAgent:e=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:e=>!1}}(),J={auto:!0};if(e)throw new Error(`you must \`import 'openai/shims/${s.kind}'\` before importing anything else from openai`);if(r)throw new Error(`can't \`import 'openai/shims/${s.kind}'\` after \`import 'openai/shims/${r}'\``);e=J.auto,r=s.kind,$=s.fetch,s.Request,s.Response,s.Headers,q=s.FormData,s.Blob,F=s.File,N=s.ReadableStream,U=s.getMultipartRequestOptions,W=s.getDefaultAgent,D=s.fileFromPath,X=s.isFsReadStream}var z,J={},K=J,V={APIConnectionError:()=>o,APIConnectionTimeoutError:()=>l,APIError:()=>i,APIUserAbortError:()=>a,AuthenticationError:()=>Q,BadRequestError:()=>G,ConflictError:()=>ee,InternalServerError:()=>ne,NotFoundError:()=>Z,OpenAIError:()=>v,PermissionDeniedError:()=>Y,RateLimitError:()=>se,UnprocessableEntityError:()=>te};for(z in V)B(K,z,{get:V[z],enumerable:!0});var v=class extends Error{},i=class extends v{constructor(e,t,s,n){super(""+i.makeMessage(e,t,s)),this.status=e,this.headers=n;s=t;this.error=s,this.code=s?.code,this.param=s?.param,this.type=s?.type}static makeMessage(e,t,s){t=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&t?e+" "+t:e?e+" status code (no body)":t||"(no status code or body)"}static generate(e,t,s,n){var r;return e?(r=t?.error,new(400===e?G:401===e?Q:403===e?Y:404===e?Z:409===e?ee:422===e?te:429===e?se:500<=e?ne:i)(e,r,s,n)):new o({cause:Me(t)})}},a=class extends i{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0),this.status=void 0}},o=class extends i{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),this.status=void 0,t&&(this.cause=t)}},l=class extends o{constructor({message:e}={}){super({message:e??"Request timed out."})}},G=class extends i{constructor(){super(...arguments),this.status=400}},Q=class extends i{constructor(){super(...arguments),this.status=401}},Y=class extends i{constructor(){super(...arguments),this.status=403}},Z=class extends i{constructor(){super(...arguments),this.status=404}},ee=class extends i{constructor(){super(...arguments),this.status=409}},te=class extends i{constructor(){super(...arguments),this.status=422}},se=class extends i{constructor(){super(...arguments),this.status=429}},ne=class extends i{},c=class{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(a,o){let s=!1;const l=new re;return new c(async function*(){if(s)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");let e=!(s=!0);try{for await(const t of async function*(){if(!a.body)throw o.abort(),new v("Attempted to iterate over a response with no body");var e=new h;for await(const n of ae(a.body))for(const r of e.decode(n)){var t=l.decode(r);t&&(yield t)}for(const i of e.flush()){var s=l.decode(i);s&&(yield s)}}())if(!e)if(t.data.startsWith("[DONE]"))e=!0;else if(null===t.event){let e;try{e=JSON.parse(t.data)}catch(e){throw console.error("Could not parse message into JSON:",t.data),console.error("From chunk:",t.raw),e}if(e&&e.error)throw new i(void 0,e.error,void 0,void 0);yield e}e=!0}catch(e){if(!(e instanceof Error&&"AbortError"===e.name))throw e}finally{e||o.abort()}},o)}static fromReadableStream(r,s){let n=!1;return new c(async function*(){if(n)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");let e=!(n=!0);try{for await(const t of async function*(){var e=new h;for await(const t of ae(r))for(const s of e.decode(t))yield s;for(const n of e.flush())yield n}())e||t&&(yield JSON.parse(t));e=!0}catch(e){if(!(e instanceof Error&&"AbortError"===e.name))throw e}finally{e||s.abort()}},s)}[Symbol.asyncIterator](){return this.iterator()}tee(){const s=[],n=[],r=this.iterator(),e=t=>({next:()=>{var e;return 0===t.length&&(e=r.next(),s.push(e),n.push(e)),t.shift()}});return[new c(()=>e(s),this.controller),new c(()=>e(n),this.controller)]}toReadableStream(){const e=this;let r;const i=new TextEncoder;return new N({async start(){r=e[Symbol.asyncIterator]()},async pull(t){try{var{value:e,done:s}=await r.next();if(s)return t.close();var n=i.encode(JSON.stringify(e)+"\n");t.enqueue(n)}catch(e){t.error(e)}},async cancel(){await r.return?.()}})}},re=class{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(s){var e;if(!(s=s.endsWith("\r")?s.substring(0,s.length-1):s))return this.event||this.data.length?(e={event:this.event,data:this.data.join("\n"),raw:this.chunks},this.event=null,this.data=[],this.chunks=[],e):null;if(this.chunks.push(s),!s.startsWith(":")){let[e,,t]=ie(s,":");t.startsWith(" ")&&(t=t.substring(1)),"event"===e?this.event=t:"data"===e&&this.data.push(t)}return null}},h=class{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let t=this.decodeText(e);if(this.trailingCR&&(t="\r"+t,this.trailingCR=!1),t.endsWith("\r")&&(this.trailingCR=!0,t=t.slice(0,-1)),!t)return[];e=h.NEWLINE_CHARS.has(t[t.length-1]||"");let s=t.split(h.NEWLINE_REGEXP);return 1!==s.length||e?(0<this.buffer.length&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),e||(this.buffer=[s.pop()||""]),s):(this.buffer.push(s[0]),[])}decodeText(e){if(null==e)return"";if("string"==typeof e)return e;if("undefined"!=typeof Buffer){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new v(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if("undefined"==typeof TextDecoder)throw new v("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.");if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new v(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}flush(){var e;return this.buffer.length||this.trailingCR?(e=[this.buffer.join("")],this.buffer=[],this.trailingCR=!1,e):[]}};function ie(e,t){var s=e.indexOf(t);return-1!==s?[e.substring(0,s),t,e.substring(s+t.length)]:[e,"",""]}function ae(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{async next(){try{var e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){var e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}h.NEWLINE_CHARS=new Set(["\n","\r","\v","\f","","","","","\u2028","\u2029"]),h.NEWLINE_REGEXP=/\r\n|[\n\r\x0b\x0c\x1c\x1d\x1e\x85\u2028\u2029]/g;var oe=e=>null!=e&&"object"==typeof e&&"string"==typeof e.url&&"function"==typeof e.blob,le=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer,ce=e=>{return null!=(t=e)&&"object"==typeof t&&"string"==typeof t.name&&"number"==typeof t.lastModified&&le(t)||oe(e)||X(e);var t};async function he(e,t,s={}){var n;return e=await e,oe(e)?(n=await e.blob(),t=t||(new URL(e.url).pathname.split(/[\\/]/).pop()??"unknown_file"),new F([n],t,s)):(n=await async function(e){var t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(le(e))t.push(await e.arrayBuffer());else{if(!pe(e))throw new Error(`Unexpected data type: ${typeof e}; constructor: ${e?.constructor?.name}; props: `+function(e){e=Object.getOwnPropertyNames(e);return`[${e.map(e=>`"${e}"`).join(", ")}]`}(e));for await(const s of e)t.push(s)}return t}(e),t||(t=(fe((e=e).name)||fe(e.filename)||fe(e.path)?.split(/[\\/]/).pop())??"unknown_file"),s.type||"string"==typeof(e=n[0]?.type)&&(s={...s,type:e}),new F(n,t,s))}function ue(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e===t&&r:t.has(e))return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s);throw new TypeError("Cannot write private member to an object whose class did not declare it")}function de(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e===t&&n:t.has(e))return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e);throw new TypeError("Cannot read private member from an object whose class did not declare it")}var u,fe=e=>"string"==typeof e?e:"undefined"!=typeof Buffer&&e instanceof Buffer?String(e):void 0,pe=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],me=e=>e&&"object"==typeof e&&e.body&&"MultipartBody"===e[Symbol.toStringTag],n=async e=>{var t=await(async e=>{const s=new q;return await Promise.all(Object.entries(e||{}).map(([e,t])=>ge(s,e,t))),s})(e.body);return U(t,e)},ge=async(s,n,e)=>{if(void 0!==e){if(null==e)throw new TypeError(`Received null for "${n}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)s.append(n,String(e));else if(ce(e)){var t=await he(e);s.append(n,t)}else if(Array.isArray(e))await Promise.all(e.map(e=>ge(s,n+"[]",e)));else{if("object"!=typeof e)throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${e} instead`);await Promise.all(Object.entries(e).map(([e,t])=>ge(s,n+`[${e}]`,t)))}}};async function ye(e){var t=e["response"];return e.options.stream?(f("response",t.status,t.url,t.headers,t.body),(e.options.__streamClass||c).fromSSEResponse(t,e.controller)):204===t.status?null:e.options.__binaryResponse?t:(e=t.headers.get("content-type"))?.includes("application/json")||e?.includes("application/vnd.api+json")?(e=await t.json(),f("response",t.status,t.url,t.headers,e),e):(e=await t.text(),f("response",t.status,t.url,t.headers,e),e)}var we=class extends Promise{constructor(e,t=ye){super(e=>{e(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(t){return new we(this.responsePromise,async e=>t(await this.parseResponse(e)))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){var[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}},e=class{constructor(e,t,s,n){u.set(this,void 0),ue(this,u,e,"f"),this.options=n,this.response=t,this.body=s}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageInfo()}async getNextPage(){var e=this.nextPageInfo();if(!e)throw new v("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");var t,s,n={...this.options};if("params"in e&&"object"==typeof n.query)n.query={...n.query,...e.params};else if("url"in e){for([t,s]of[...Object.entries(n.query||{}),...e.url.searchParams.entries()])e.url.searchParams.set(t,s);n.query=void 0,n.path=e.url.toString()}return de(this,u,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)yield e=await e.getNextPage()}async*[(u=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}},be=class extends we{constructor(t,e,s){super(e,async e=>new s(t,e.response,await ye(e),e.options))}async*[Symbol.asyncIterator](){for await(const e of await this)yield e}},ve=e=>new Proxy(Object.fromEntries(e.entries()),{get(e,t){t=t.toString();return e[t.toLowerCase()]||e[t]}}),_e={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryResponse:!0,__streamClass:!0},d=e=>"object"==typeof e&&null!==e&&!Te(e)&&Object.keys(e).every(e=>je(_e,e)),xe=()=>{var e;return"undefined"!=typeof Deno&&null!=Deno.build?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":t,"X-Stainless-OS":Ae(Deno.build.os),"X-Stainless-Arch":Pe(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":Deno.version}:"undefined"!=typeof EdgeRuntime?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"other:"+EdgeRuntime,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version}:"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":t,"X-Stainless-OS":Ae(process.platform),"X-Stainless-Arch":Pe(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version}:(e=function(){if("undefined"!=typeof navigator&&navigator){var e,t;for({key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){var s,n,r=t.exec(navigator.userAgent);if(r)return s=r[1]||0,n=r[2]||0,r=r[3]||0,{browser:e,version:s+`.${n}.`+r}}}return null}())?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"browser:"+e.browser,"X-Stainless-Runtime-Version":e.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":t,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};var Se,Pe=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?"other:"+e:"unknown",Ae=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?"Other:"+e:"Unknown",Re=()=>Se=Se??xe(),Ce=e=>{try{return JSON.parse(e)}catch(e){}},Ee=new RegExp("^(?:[a-z]+:)?//","i"),Ie=e=>Ee.test(e),Oe=t=>new Promise(e=>setTimeout(e,t)),ke=(e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new v(e+" must be an integer");if(t<0)throw new v(e+" must be a positive integer");return t},Me=e=>e instanceof Error?e:new Error(e),Le=e=>"undefined"!=typeof process?process.env?.[e]?.trim()??void 0:"undefined"!=typeof Deno?Deno.env?.get?.(e)?.trim():void 0;function Te(e){if(e)for(const t in e)return;return 1}function je(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Be(e,t){for(const r in t){var s,n;je(t,r)&&(s=r.toLowerCase())&&(null===(n=t[r])?delete e[s]:void 0!==n&&(e[s]=n))}}function f(e,...t){"undefined"!=typeof process&&"true"===process.env.DEBUG&&console.log("OpenAI:DEBUG:"+e,...t)}var $e=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),qe=()=>"undefined"!=typeof window&&void 0!==window.document&&"undefined"!=typeof navigator,s=class extends e{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[],this.object=s.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}},e=class extends e{constructor(e,t,s,n){super(e,t,s,n),this.data=s.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){var e=this.nextPageInfo();return e?"params"in e?e.params:(e=Object.fromEntries(e.url.searchParams),Object.keys(e).length?e:null):null}nextPageInfo(){var e=this.getPaginatedItems();return e.length&&(e=e[e.length-1]?.id)?{params:{after:e}}:null}},p=class{constructor(e){this._client=e}},Fe=(Fe=class extends p{create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}})||{},m=class extends p{constructor(){super(...arguments),this.completions=new Fe(this._client)}};(m=m||{}).Completions=Fe;var Ne=(Ne=class extends p{create(e,t){return this._client.post("/audio/speech",{body:e,...t,__binaryResponse:!0})}})||{},Ue=(Ue=class extends p{create(e,t){return this._client.post("/audio/transcriptions",n({body:e,...t}))}})||{},We=(We=class extends p{create(e,t){return this._client.post("/audio/translations",n({body:e,...t}))}})||{},g=class extends p{constructor(){super(...arguments),this.transcriptions=new Ue(this._client),this.translations=new We(this._client),this.speech=new Ne(this._client)}},y=((C=g=g||{}).Transcriptions=Ue,C.Translations=We,C.Speech=Ne,class extends p{create(e,t,s){return this._client.post(`/assistants/${e}/files`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/assistants/${e}/files/`+t,{...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}list(e,t={},s){return d(t)?this.list(e,{},t):this._client.getAPIList(`/assistants/${e}/files`,De,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}del(e,t,s){return this._client.delete(`/assistants/${e}/files/`+t,{...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}}),De=class extends e{},w=((y=y||{}).AssistantFilesPage=De,class extends p{constructor(){super(...arguments),this.files=new y(this._client)}create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}retrieve(e,t){return this._client.get("/assistants/"+e,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}update(e,t,s){return this._client.post("/assistants/"+e,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}list(e={},t){return d(e)?this.list({},e):this._client.getAPIList("/assistants",Xe,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}del(e,t){return this._client.delete("/assistants/"+e,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}}),Xe=class extends e{};function He(e){return"function"==typeof e.parse}(C=w=w||{}).AssistantsPage=Xe,C.Files=y,C.AssistantFilesPage=De;function b(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e===t&&r:t.has(e))return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s);throw new TypeError("Cannot write private member to an object whose class did not declare it")}function _(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e===t&&n:t.has(e))return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e);throw new TypeError("Cannot read private member from an object whose class did not declare it")}function S(e,t,s,n){if("a"===s&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e===t&&n:t.has(e))return"m"===s?n:"a"===s?n.call(e):n?n.value:t.get(e);throw new TypeError("Cannot read private member from an object whose class did not declare it")}function Je(e,t,s,n,r){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e===t&&r:t.has(e))return"a"===n?r.call(e,s):r?r.value=s:t.set(e,s),s;throw new TypeError("Cannot write private member to an object whose class did not declare it")}var x,P,ze,Ke,A,Ve,R=e=>"assistant"===e?.role,Ge=e=>"function"===e?.role,Qe=e=>"tool"===e?.role,C=class{constructor(){L.add(this),this.controller=new AbortController,Ye.set(this,void 0),Ze.set(this,()=>{}),E.set(this,()=>{}),I.set(this,void 0),et.set(this,()=>{}),O.set(this,()=>{}),k.set(this,{}),this._chatCompletions=[],this.messages=[],tt.set(this,!1),st.set(this,!1),nt.set(this,!1),M.set(this,!1),rt.set(this,e=>{var t;return b(this,st,!0,"f"),(e=e instanceof Error&&"AbortError"===e.name?new a:e)instanceof a?(b(this,nt,!0,"f"),this._emit("abort",e)):e instanceof v?this._emit("error",e):e instanceof Error?((t=new v(e.message)).cause=e,this._emit("error",t)):this._emit("error",new v(String(e)))}),b(this,Ye,new Promise((e,t)=>{b(this,Ze,e,"f"),b(this,E,t,"f")}),"f"),b(this,I,new Promise((e,t)=>{b(this,et,e,"f"),b(this,O,t,"f")}),"f"),_(this,Ye,"f").catch(()=>{}),_(this,I,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},_(this,rt,"f"))},0)}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);var t=e.choices[0]?.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t)if(this._emit("message",e),(Ge(e)||Qe(e))&&e.content)this._emit("functionCallResult",e.content);else if(R(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(R(e)&&e.tool_calls)for(const s of e.tool_calls)"function"===s.type&&this._emit("functionCall",s.function)}_connected(){this.ended||(_(this,Ze,"f").call(this),this._emit("connect"))}get ended(){return _(this,tt,"f")}get errored(){return _(this,st,"f")}get aborted(){return _(this,nt,"f")}abort(){this.controller.abort()}on(e,t){return(_(this,k,"f")[e]||(_(this,k,"f")[e]=[])).push({listener:t}),this}off(e,t){var s,e=_(this,k,"f")[e];return e&&0<=(s=e.findIndex(e=>e.listener===t))&&e.splice(s,1),this}once(e,t){return(_(this,k,"f")[e]||(_(this,k,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(s){return new Promise((e,t)=>{b(this,M,!0,"f"),"error"!==s&&this.once("error",t),this.once(s,e)})}async done(){b(this,M,!0,"f"),await _(this,I,"f")}async finalChatCompletion(){await this.done();var e=this._chatCompletions[this._chatCompletions.length-1];if(e)return e;throw new v("stream ended without producing a ChatCompletion")}async finalContent(){return await this.done(),_(this,L,"m",it).call(this)}async finalMessage(){return await this.done(),_(this,L,"m",at).call(this)}async finalFunctionCall(){return await this.done(),_(this,L,"m",ot).call(this)}async finalFunctionCallResult(){return await this.done(),_(this,L,"m",lt).call(this)}async totalUsage(){return await this.done(),_(this,L,"m",ct).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emit(e,...t){var s,n;_(this,tt,"f")||("end"===e&&(b(this,tt,!0,"f"),_(this,et,"f").call(this)),(s=_(this,k,"f")[e])&&(_(this,k,"f")[e]=s.filter(e=>!e.once),s.forEach(({listener:e})=>e(...t))),"abort"===e?(n=t[0],_(this,M,"f")||s?.length||Promise.reject(n),_(this,E,"f").call(this,n),_(this,O,"f").call(this,n),this._emit("end")):"error"===e&&(n=t[0],_(this,M,"f")||s?.length||Promise.reject(n),_(this,E,"f").call(this,n),_(this,O,"f").call(this,n),this._emit("end")))}_emitFinal(){var e=this._chatCompletions[this._chatCompletions.length-1],e=(e&&this._emit("finalChatCompletion",e),_(this,L,"m",at).call(this)),e=(e&&this._emit("finalMessage",e),_(this,L,"m",it).call(this)),e=(e&&this._emit("finalContent",e),_(this,L,"m",ot).call(this)),e=(e&&this._emit("finalFunctionCall",e),_(this,L,"m",lt).call(this));null!=e&&this._emit("finalFunctionCallResult",e),this._chatCompletions.some(e=>e.usage)&&this._emit("totalUsage",_(this,L,"m",ct).call(this))}async _createChatCompletion(e,t,s){var n=s?.signal,n=(n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),_(this,L,"m",ht).call(this,t),await e.create({...t,stream:!1},{...s,signal:this.controller.signal}));return this._connected(),this._addChatCompletion(n)}async _runChatCompletion(e,t,s){for(const n of t.messages)this._addMessage(n,!1);return this._createChatCompletion(e,t,s)}async _runFunctions(t,e,s){var n="function";const{function_call:r="auto",stream:i,...a}=e;var o="string"!=typeof r&&r?.name,{maxChatCompletions:l=10}=s||{},c={};for(const m of e.functions)c[m.name||m.function.name]=m;var h=e.functions.map(e=>({name:e.name||e.function.name,parameters:e.parameters,description:e.description}));for(const g of e.messages)this._addMessage(g,!1);for(let e=0;e<l;++e){var u=(await this._createChatCompletion(t,{...a,function_call:r,functions:h,messages:[...this.messages]},s)).choices[0]?.message;if(!u)throw new v("missing message in ChatCompletion response");if(!u.function_call)return;var{name:u,arguments:d}=u.function_call,f=c[u];if(f)if(o&&o!==u){var p=`Invalid function_call: ${JSON.stringify(u)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:n,name:u,content:p})}else{let e;try{e=He(f)?await f.parse(d):d}catch(e){this._addMessage({role:n,name:u,content:e instanceof Error?e.message:String(e)});continue}p=await f.function(e,this),d=_(this,L,"m",ut).call(this,p);if(this._addMessage({role:n,name:u,content:d}),o)return}else{f=`Invalid function_call: ${JSON.stringify(u)}. Available options are: ${h.map(e=>JSON.stringify(e.name)).join(", ")}. Please try again`;this._addMessage({role:n,name:u,content:f})}}}async _runTools(t,e,s){var n="tool";const{tool_choice:r="auto",stream:i,...a}=e;var o="string"!=typeof r&&r?.function?.name,{maxChatCompletions:l=10}=s||{},c={};for(const y of e.tools)"function"===y.type&&(c[y.function.name||y.function.function.name]=y.function);var h="tools"in e?e.tools.map(e=>"function"===e.type?{type:"function",function:{name:e.function.name||e.function.function.name,parameters:e.function.parameters,description:e.function.description}}:e):void 0;for(const w of e.messages)this._addMessage(w,!1);for(let e=0;e<l;++e){var u=(await this._createChatCompletion(t,{...a,tool_choice:r,tools:h,messages:[...this.messages]},s)).choices[0]?.message;if(!u)throw new v("missing message in ChatCompletion response");if(!u.tool_calls)return;for(const b of u.tool_calls)if("function"===b.type){var d=b.id,{name:f,arguments:p}=b.function,m=c[f];if(m)if(o&&o!==f){var g=`Invalid tool_call: ${JSON.stringify(f)}. ${JSON.stringify(o)} requested. Please try again`;this._addMessage({role:n,tool_call_id:d,content:g})}else{let e;try{e=He(m)?await m.parse(p):p}catch(e){g=e instanceof Error?e.message:String(e);this._addMessage({role:n,tool_call_id:d,content:g});continue}p=await m.function(e,this),m=_(this,L,"m",ut).call(this,p);if(this._addMessage({role:n,tool_call_id:d,content:m}),o)return}else{p=`Invalid tool_call: ${JSON.stringify(f)}. Available options are: ${h.map(e=>JSON.stringify(e.function.name)).join(", ")}. Please try again`;this._addMessage({role:n,tool_call_id:d,content:p})}}}}},Ye=new WeakMap,Ze=new WeakMap,E=new WeakMap,I=new WeakMap,et=new WeakMap,O=new WeakMap,k=new WeakMap,tt=new WeakMap,st=new WeakMap,nt=new WeakMap,M=new WeakMap,rt=new WeakMap,L=new WeakSet,it=function(){return _(this,L,"m",at).call(this).content??null},at=function(){let e=this.messages.length;for(;0<e--;){var t=this.messages[e];if(R(t))return{...t,content:t.content??null}}throw new v("stream ended without producing a ChatCompletionMessage with role=assistant")},ot=function(){for(let e=this.messages.length-1;0<=e;e--){var t=this.messages[e];if(R(t)&&t?.function_call)return t.function_call;if(R(t)&&t?.tool_calls?.length)return t.tool_calls.at(-1)?.function}},lt=function(){for(let e=this.messages.length-1;0<=e;e--){const t=this.messages[e];if(Ge(t)&&null!=t.content)return t.content;if(Qe(t)&&null!=t.content&&this.messages.some(e=>"assistant"===e.role&&e.tool_calls?.some(e=>"function"===e.type&&e.id===t.tool_call_id)))return t.content}},ct=function(){var e,t={completion_tokens:0,prompt_tokens:0,total_tokens:0};for({usage:e}of this._chatCompletions)e&&(t.completion_tokens+=e.completion_tokens,t.prompt_tokens+=e.prompt_tokens,t.total_tokens+=e.total_tokens);return t},ht=function(e){if(null!=e.n&&1<e.n)throw new v("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},ut=function(e){return"string"==typeof e?e:void 0===e?"undefined":JSON.stringify(e)},dt=class extends C{static runFunctions(e,t,s){const n=new dt,r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,r)),n}static runTools(e,t,s){const n=new dt,r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,r)),n}_addMessage(e){super._addMessage(e),R(e)&&e.content&&this._emit("content",e.content)}},ft=class extends C{constructor(){super(...arguments),x.add(this),P.set(this,void 0)}get currentChatCompletionSnapshot(){return S(this,P,"f")}static fromReadableStream(e){const t=new ft;return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,s){const n=new ft;return n._run(()=>n._runChatCompletion(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),n}async _createChatCompletion(e,t,s){var n=s?.signal,n=(n&&(n.aborted&&this.controller.abort(),n.addEventListener("abort",()=>this.controller.abort())),S(this,x,"m",ze).call(this),await e.create({...t,stream:!0},{...s,signal:this.controller.signal}));this._connected();for await(const r of n)S(this,x,"m",Ke).call(this,r);if(n.controller.signal?.aborted)throw new a;return this._addChatCompletion(S(this,x,"m",A).call(this))}async _fromReadableStream(e,t){t=t?.signal,t&&(t.aborted&&this.controller.abort(),t.addEventListener("abort",()=>this.controller.abort())),S(this,x,"m",ze).call(this),this._connected(),t=c.fromReadableStream(e,this.controller);let s;for await(const n of t)s&&s!==n.id&&this._addChatCompletion(S(this,x,"m",A).call(this)),S(this,x,"m",Ke).call(this,n),s=n.id;if(t.controller.signal?.aborted)throw new a;return this._addChatCompletion(S(this,x,"m",A).call(this))}[(P=new WeakMap,x=new WeakSet,ze=function(){this.ended||Je(this,P,void 0,"f")},Ke=function(e){var t;this.ended||(t=S(this,x,"m",Ve).call(this,e),this._emit("chunk",e,t),e=e.choices[0]?.delta?.content,t=t.choices[0]?.message,null!=e&&"assistant"===t?.role&&t?.content&&this._emit("content",e,t.content))},A=function(){if(this.ended)throw new v("stream has ended, this shouldn't happen");var e=S(this,P,"f");if(e)return Je(this,P,void 0,"f"),pt(e);throw new v("request ended without sending any chunks")},Ve=function(e){var t,s,n,r,i,a;let o=S(this,P,"f");const{choices:l,...c}=e;o?Object.assign(o,c):o=Je(this,P,{...c,choices:[]},"f");for({delta:s,finish_reason:n,index:r,logprobs:i=null,...a}of e.choices){let e=o.choices[r];if(e=e||(o.choices[r]={finish_reason:n,index:r,message:{},logprobs:i,...a}),i)if(e.logprobs){const{content:g,...y}=i;Object.assign(e.logprobs,y),g&&((t=e.logprobs).content??(t.content=[]),e.logprobs.content.push(...g))}else e.logprobs=Object.assign({},i);if(n&&(e.finish_reason=n),Object.assign(e,a),s){const{content:w,function_call:b,role:v,tool_calls:_,...x}=s;if(Object.assign(e.message,x),w&&(e.message.content=(e.message.content||"")+w),v&&(e.message.role=v),b&&(e.message.function_call?(b.name&&(e.message.function_call.name=b.name),b.arguments&&((t=e.message.function_call).arguments??(t.arguments=""),e.message.function_call.arguments+=b.arguments)):e.message.function_call=b),_){e.message.tool_calls||(e.message.tool_calls=[]);for(var{index:h,id:u,type:d,function:f,...p}of _){var m=(m=e.message.tool_calls)[h]??(m[h]={});Object.assign(m,p),u&&(m.id=u),d&&(m.type=d),f&&(m.function??(m.function={arguments:""})),f?.name&&(m.function.name=f.name),f?.arguments&&(m.function.arguments+=f.arguments)}}}}return o},Symbol.asyncIterator)](){const s=[],n=[];let t=!1;return this.on("chunk",e=>{var t=n.shift();t?t(e):s.push(e)}),this.on("end",()=>{t=!0;for(const e of n)e(void 0);n.length=0}),{next:async()=>{return s.length?{value:s.shift(),done:!1}:t?{value:void 0,done:!0}:new Promise(e=>n.push(e)).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0})}}}toReadableStream(){return new c(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}};function pt(u){const{id:e,choices:t,created:s,model:n,system_fingerprint:r,...i}=u;return{...i,id:e,choices:t.map(({message:e,finish_reason:t,index:c,logprobs:s,...n})=>{if(!t)throw new v("missing finish_reason for choice "+c);const{content:r=null,function_call:i,tool_calls:a,...o}=e;e=e.role;if(!e)throw new v("missing role for choice "+c);if(i){var{arguments:l,name:h}=i;if(null==l)throw new v("missing function_call.arguments for choice "+c);if(h)return{...n,message:{content:r,function_call:{arguments:l,name:h},role:e},finish_reason:t,index:c,logprobs:s};throw new v("missing function_call.name for choice "+c)}return a?{...n,index:c,finish_reason:t,logprobs:s,message:{...o,role:e,content:r,tool_calls:a.map((e,t)=>{const{function:s,type:n,id:r,...i}=e,{arguments:a,name:o,...l}=s||{};if(null==r)throw new v(`missing choices[${c}].tool_calls[${t}].id
`+mt(u));if(null==n)throw new v(`missing choices[${c}].tool_calls[${t}].type
`+mt(u));if(null==o)throw new v(`missing choices[${c}].tool_calls[${t}].function.name
`+mt(u));if(null==a)throw new v(`missing choices[${c}].tool_calls[${t}].function.arguments
`+mt(u));return{...i,id:r,type:n,function:{...l,name:o,arguments:a}}})}}:{...n,message:{...o,content:r,role:e},finish_reason:t,index:c,logprobs:s}}),created:s,model:n,object:"chat.completion",...r?{system_fingerprint:r}:{}}}function mt(e){return JSON.stringify(e)}var T=class extends ft{static fromReadableStream(e){const t=new T;return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,s){const n=new T,r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return n._run(()=>n._runFunctions(e,t,r)),n}static runTools(e,t,s){const n=new T,r={...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"runTools"}};return n._run(()=>n._runTools(e,t,r)),n}},gt=class extends p{runFunctions(e,t){return(e.stream?T:dt).runFunctions(this._client.chat.completions,e,t)}runTools(e,t){return(e.stream?T:dt).runTools(this._client.chat.completions,e,t)}stream(e,t){return ft.createChatCompletion(this._client.chat.completions,e,t)}},yt=class extends p{constructor(){super(...arguments),this.completions=new gt(this._client)}},wt=((yt=yt||{}).Completions=gt,class extends p{retrieve(e,t,s,n){return this._client.get(`/threads/${e}/messages/${t}/files/`+s,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(e,t,s={},n){return d(s)?this.list(e,t,{},s):this._client.getAPIList(`/threads/${e}/messages/${t}/files`,bt,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}),bt=class extends e{},vt=((wt=wt||{}).MessageFilesPage=bt,class extends p{constructor(){super(...arguments),this.files=new wt(this._client)}create(e,t,s){return this._client.post(`/threads/${e}/messages`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/threads/${e}/messages/`+t,{...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/messages/`+t,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(e,t={},s){return d(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,_t,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}}),_t=class extends e{},xt=((C=vt=vt||{}).ThreadMessagesPage=_t,C.Files=wt,C.MessageFilesPage=bt,class extends p{retrieve(e,t,s,n){return this._client.get(`/threads/${e}/runs/${t}/steps/`+s,{...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(e,t,s={},n){return d(s)?this.list(e,t,{},s):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,St,{query:s,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}),St=class extends e{},Pt=((xt=xt||{}).RunStepsPage=St,class extends p{constructor(){super(...arguments),this.steps=new xt(this._client)}create(e,t,s){return this._client.post(`/threads/${e}/runs`,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}retrieve(e,t,s){return this._client.get(`/threads/${e}/runs/`+t,{...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}update(e,t,s,n){return this._client.post(`/threads/${e}/runs/`+t,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}list(e,t={},s){return d(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,At,{query:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}cancel(e,t,s){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}submitToolOutputs(e,t,s,n){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:s,...n,headers:{"OpenAI-Beta":"assistants=v1",...n?.headers}})}}),At=class extends e{},Rt=((C=Pt=Pt||{}).RunsPage=At,C.Steps=xt,C.RunStepsPage=St,class extends p{constructor(){super(...arguments),this.runs=new Pt(this._client),this.messages=new vt(this._client)}create(e={},t){return d(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}retrieve(e,t){return this._client.get("/threads/"+e,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}update(e,t,s){return this._client.post("/threads/"+e,{body:t,...s,headers:{"OpenAI-Beta":"assistants=v1",...s?.headers}})}del(e,t){return this._client.delete("/threads/"+e,{...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v1",...t?.headers}})}}),Ct=((C=Rt=Rt||{}).Runs=Pt,C.RunsPage=At,C.Messages=vt,C.ThreadMessagesPage=_t,class extends p{constructor(){super(...arguments),this.chat=new yt(this._client),this.assistants=new w(this._client),this.threads=new Rt(this._client)}});(C=Ct=Ct||{}).Chat=yt,C.Assistants=w,C.AssistantsPage=Xe,C.Threads=Rt;var Et=(Et=class extends p{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}})||{},It=(It=class extends p{create(e,t){return this._client.post("/embeddings",{body:e,...t})}})||{},Ot=class extends p{create(e,t){return this._client.post("/files",n({body:e,...t}))}retrieve(e,t){return this._client.get("/files/"+e,t)}list(e={},t){return d(e)?this.list({},e):this._client.getAPIList("/files",kt,{query:e,...t})}del(e,t){return this._client.delete("/files/"+e,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/json",...t?.headers}})}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:s=18e5}={}){var n=new Set(["processed","error","deleted"]),r=Date.now();let i=await this.retrieve(e);for(;!i.status||!n.has(i.status);)if(await Oe(t),i=await this.retrieve(e),Date.now()-r>s)throw new l({message:`Giving up on waiting for file ${e} to finish processing after ${s} milliseconds.`});return i}},kt=class extends s{},Mt=((Ot=Ot||{}).FileObjectsPage=kt,class extends p{create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get("/fine_tuning/jobs/"+e,t)}list(e={},t){return d(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Lt,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},s){return d(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Tt,{query:t,...s})}}),Lt=class extends e{},Tt=class extends e{},jt=((C=Mt=Mt||{}).FineTuningJobsPage=Lt,C.FineTuningJobEventsPage=Tt,class extends p{constructor(){super(...arguments),this.jobs=new Mt(this._client)}});(C=jt=jt||{}).Jobs=Mt,C.FineTuningJobsPage=Lt,C.FineTuningJobEventsPage=Tt;var Bt=(Bt=class extends p{createVariation(e,t){return this._client.post("/images/variations",n({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",n({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}})||{},$t=class extends p{retrieve(e,t){return this._client.get("/models/"+e,t)}list(e){return this._client.getAPIList("/models",qt,e)}del(e,t){return this._client.delete("/models/"+e,t)}},qt=class extends s{};($t=$t||{}).ModelsPage=qt;var Ft=(Ft=class extends p{create(e,t){return this._client.post("/moderations",{body:e,...t})}})||{},C=class extends class{constructor({baseURL:e,maxRetries:t=2,timeout:s=6e5,httpAgent:n,fetch:r}){this.baseURL=e,this.maxRetries=ke("maxRetries",t),this.timeout=ke("timeout",s),this.httpAgent=n,this.fetch=r??$}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Re(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return"stainless-node-retry-"+$e()}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(t,s,e){return this.request(Promise.resolve(e).then(e=>({method:t,path:s,...e})))}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}calculateContentLength(e){if("string"==typeof e){if("undefined"!=typeof Buffer)return Buffer.byteLength(e,"utf8").toString();if("undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e).length.toString()}return null}buildRequest(e){var{method:t,path:s,query:n,headers:r={}}=e,i=me(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,a=this.calculateContentLength(i),s=this.buildURL(s,n),n=("timeout"in e&&ke("timeout",e.timeout),e.timeout??this.timeout),o=e.httpAgent??this.httpAgent??W(s),l=n+1e3,l=("number"==typeof o?.options?.timeout&&l>(o.options.timeout??0)&&(o.options.timeout=l),this.idempotencyHeader&&"get"!==t&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),r[this.idempotencyHeader]=e.idempotencyKey),this.buildHeaders({options:e,headers:r,contentLength:a}));return{req:{method:t,...i&&{body:i},headers:l,...o&&{agent:o},signal:e.signal??null},url:s,timeout:n}}buildHeaders({options:e,headers:t,contentLength:s}){var n={},s=(s&&(n["content-length"]=s),this.defaultHeaders(e));return Be(n,s),Be(n,t),me(e.body)&&"node"!==r&&delete n["content-type"],this.validateHeaders(n,t),n}async prepareOptions(e){}async prepareRequest(e,{}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(e=>[...e])):{...e}:{}}makeStatusError(e,t,s,n){return i.generate(e,t,s,n)}request(e,t=null){return new we(this.makeRequest(e,t))}async makeRequest(e,t){var e=await e,{req:s,url:n,timeout:r}=(null==t&&(t=e.maxRetries??this.maxRetries),await this.prepareOptions(e),this.buildRequest(e));if(await this.prepareRequest(s,{url:n,options:e}),f("request",n,e,s.headers),e.signal?.aborted)throw new a;var i=new AbortController,s=await this.fetchWithTimeout(n,s,r,i).catch(Me);if(s instanceof Error){if(e.signal?.aborted)throw new a;if(t)return this.retryRequest(e,t);if("AbortError"===s.name)throw new l;throw new o({cause:s})}r=ve(s.headers);if(s.ok)return{response:s,options:e,controller:i};if(t&&this.shouldRetry(s))return f(`response (error; ${`retrying, ${t} attempts remaining`})`,s.status,n,r),this.retryRequest(e,t,r);i=await s.text().catch(e=>Me(e).message),e=Ce(i),i=e?void 0:i,f(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,s.status,n,r,i),t=this.makeStatusError(s.status,e,i,r);throw t}requestAPIList(e,t){t=this.makeRequest(t,null);return new be(this,t,e)}buildURL(e,t){var e=Ie(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return"object"==typeof(t=Te(s)?t:{...s,...t})&&t&&!Array.isArray(t)&&(e.search=this.stringifyQuery(t)),e.toString()}stringifyQuery(e){return Object.entries(e).filter(([,e])=>void 0!==e).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return encodeURIComponent(e)+"="+encodeURIComponent(t);if(null===t)return encodeURIComponent(e)+"=";throw new v(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,s,n){const{signal:r,...i}=t||{},a=(r&&r.addEventListener("abort",()=>n.abort()),setTimeout(()=>n.abort(),s));return this.getRequestClient().fetch.call(void 0,e,{signal:n.signal,...i}).finally(()=>{clearTimeout(a)})}getRequestClient(){return{fetch:this.fetch}}shouldRetry(e){var t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||500<=e.status)}async retryRequest(e,t,s){let n;var r=s?.["retry-after-ms"],r=(r&&(r=parseFloat(r),Number.isNaN(r)||(n=r)),s?.["retry-after"]);return r&&!n&&(s=parseFloat(r),n=Number.isNaN(s)?Date.parse(r)-Date.now():1e3*s),n&&0<=n&&n<6e4||(r=e.maxRetries??this.maxRetries,n=this.calculateDefaultRetryTimeoutMillis(t,r)),await Oe(n),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}getUserAgent(){return this.constructor.name+"/JS "+t}}{constructor({baseURL:e=Le("OPENAI_BASE_URL"),apiKey:t=Le("OPENAI_API_KEY"),organization:s=Le("OPENAI_ORG_ID")??null,...n}={}){if(void 0===t)throw new v("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");n={apiKey:t,organization:s,...n,baseURL:e||"https://api.openai.com/v1"};if(!n.dangerouslyAllowBrowser&&qe())throw new v("It looks like you're running in a browser-like environment.\n\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\nIf you understand the risks and have appropriate mitigations in place,\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\n\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\n\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\n");super({baseURL:n.baseURL,timeout:n.timeout??6e5,httpAgent:n.httpAgent,maxRetries:n.maxRetries,fetch:n.fetch}),this.completions=new Et(this),this.chat=new m(this),this.embeddings=new It(this),this.files=new Ot(this),this.images=new Bt(this),this.audio=new g(this),this.moderations=new Ft(this),this.models=new $t(this),this.fineTuning=new jt(this),this.beta=new Ct(this),this._options=n,this.apiKey=t,this.organization=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:"Bearer "+this.apiKey}}},p=C,Nt=(C.OpenAI=p,C.OpenAIError=v,C.APIError=i,C.APIConnectionError=o,C.APIConnectionTimeoutError=l,C.APIUserAbortError=a,C.NotFoundError=Z,C.ConflictError=ee,C.RateLimitError=se,C.BadRequestError=G,C.AuthenticationError=Q,C.InternalServerError=ne,C.PermissionDeniedError=Y,C.UnprocessableEntityError=te,(p=C=C||{}).toFile=he,p.fileFromPath=D,p.Page=s,p.CursorPage=e,p.Completions=Et,p.Chat=m,p.Embeddings=It,p.Files=Ot,p.FileObjectsPage=kt,p.Images=Bt,p.Audio=g,p.Moderations=Ft,p.Models=$t,p.ModelsPage=qt,p.FineTuning=jt,p.Beta=Ct,C),Ut=null,j=null,Wt=null;function Dt(){console.log(j)}async function Xt(){Ut=j,(j=document.querySelector(".main-playlistEditDetailsModal-container"))&&!j.isEqualNode(Ut)&&(Ut&&Wt.disconnect(),Dt(),Wt.observe(j,{childList:!0,subtree:!0}))}Spicetify.ReactComponent.IconComponent({semanticColor:"textBase",dangerouslySetInnerHTML:{__html:'<path d="M5.25 3v-.917C5.25.933 6.183 0 7.333 0h1.334c1.15 0 2.083.933 2.083 2.083V3h4.75v1.5h-.972l-1.257 9.544A2.25 2.25 0 0 1 11.041 16H4.96a2.25 2.25 0 0 1-2.23-1.956L1.472 4.5H.5V3h4.75zm1.5-.917V3h2.5v-.917a.583.583 0 0 0-.583-.583H7.333a.583.583 0 0 0-.583.583zM2.986 4.5l1.23 9.348a.75.75 0 0 0 .744.652h6.08a.75.75 0 0 0 .744-.652L13.015 4.5H2.985z"></path>'},iconSize:16}),new Spicetify.PlaylistEditModalV2.Item({children:"Generate photo",leadingIcon:'<svg class="Svg-img-icon-small-textSubdued" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">\x3c!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--\x3e<path d="M234.7 42.7L197 56.8c-3 1.1-5 4-5 7.2s2 6.1 5 7.2l37.7 14.1L248.8 123c1.1 3 4 5 7.2 5s6.1-2 7.2-5l14.1-37.7L315 71.2c3-1.1 5-4 5-7.2s-2-6.1-5-7.2L277.3 42.7 263.2 5c-1.1-3-4-5-7.2-5s-6.1 2-7.2 5L234.7 42.7zM46.1 395.4c-18.7 18.7-18.7 49.1 0 67.9l34.6 34.6c18.7 18.7 49.1 18.7 67.9 0L529.9 116.5c18.7-18.7 18.7-49.1 0-67.9L495.3 14.1c-18.7-18.7-49.1-18.7-67.9 0L46.1 395.4zM484.6 82.6l-105 105-23.3-23.3 105-105 23.3 23.3zM7.5 117.2C3 118.9 0 123.2 0 128s3 9.1 7.5 10.8L64 160l21.2 56.5c1.7 4.5 6 7.5 10.8 7.5s9.1-3 10.8-7.5L128 160l56.5-21.2c4.5-1.7 7.5-6 7.5-10.8s-3-9.1-7.5-10.8L128 96 106.8 39.5C105.1 35 100.8 32 96 32s-9.1 3-10.8 7.5L64 96 7.5 117.2zm352 256c-4.5 1.7-7.5 6-7.5 10.8s3 9.1 7.5 10.8L416 416l21.2 56.5c1.7 4.5 6 7.5 10.8 7.5s9.1-3 10.8-7.5L480 416l56.5-21.2c4.5-1.7 7.5-6 7.5-10.8s-3-9.1-7.5-10.8L480 352l-21.2-56.5c-1.7-4.5-6-7.5-10.8-7.5s-9.1 3-10.8 7.5L416 352l-56.5 21.2z"/></svg>',onClick:()=>{console.log("Item clicked!")},shouldAdd:e=>{return"Change photo"===(null==(e=null==(e=null==(e=null==e?void 0:e.children)?void 0:e[0])?void 0:e.props)?void 0:e.children)}});var Ht=async function(){for(;null==Spicetify||!Spicetify.showNotification;)await new Promise(e=>setTimeout(e,100));Spicetify.showNotification("Hello!"),new Nt({apiKey:"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",dangerouslyAllowBrowser:!0}),Wt=new MutationObserver(()=>{Dt()});var e=new MutationObserver(async()=>{await Xt()});await Xt(),e.observe(document.body,{childList:!0,subtree:!0})};(async()=>{await Ht()})()})()}();